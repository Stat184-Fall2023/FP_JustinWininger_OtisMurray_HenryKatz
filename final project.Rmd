---
title: "Final Project"
author: "Justin Wininger, Otis Murray, Henry Katz"
date: "2023-11-29"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(Stat2Data)
library(tidyverse)
library(mosaic)
library(ggformula)
library(Lock5Data)
library(tinytex)
library(car)
library(leaps)
library(HH)
library(rvest)
library(dplyr)
library(readr)
library(ggplot2)
library(tidyr)
library(readxl)
library(esquisse)
```


```{r create nfl dataframe}
#create nfl table
nflTable <- read_html(
  x = "http://pfref.com/pi/share/d7riA"
) %>%
  html_elements(css = "table") %>%
  html_table()
nflOffense <- nflTable[[1]]

#delete unnecessary data
nflOffense <- subset(nflOffense, select=-c(1, 6:28))
nflOffense <- nflOffense[-c(1, 22:23, 36:38), ]

#rename columns 
nflOffense <- nflOffense%>%rename(
  `Team`=1, `Games`=2, `Points`=3, `Yards`=4)

#squish team names
nflOffense$Team <- sub(".*\\s", "", nflOffense$Team)

#rearrange column order
nflOffense <- nflOffense[,c("Team", "Games","Points","Yards")]
```

nflOffense$Games <- as.numeric(nflOffense$Games)
nflOffense$Points <- as.numeric(nflOffense$Points)
nflOffense$Yards <- as.numeric(nflOffense$Yards)
```

```{r}
esquisse::esquisser(data=nflOffense, viewer = 'browser')
```


```{r nfl visualizations}
gf_point(`Points Per Game`~`Yards Per Game`, data=nflOffense, linewidth=1)%>%gf_lm()
```

```{r regression anaylsis}
nflModel <- lm(Points~Yards, data=nflOffense)
mplot(nflModel, which=1)
mplot(nflModel, which=2)
cooksplot(nflModel)
summary(nflModel)
```




```{r create college dataframe}
collegeTable <- read_html(
  x = "https://www.sports-reference.com/cfb/years/2022-team-offense.html"
) %>%
  html_elements(css = "table") %>%
  html_table()
collegeOffense <- collegeTable[[1]]

<<<<<<< Updated upstream
collegeOffense <- subset(collegeOffense, select=-c(1, 5:14, 16:25))
=======
collegeOffense <- subset(collegeOffense, select=-c(1, 3, 5:7, 9:10, 12:14, 16:25))
>>>>>>> Stashed changes

collegeOffense <- collegeOffense%>%rename(
   `Team`=1, `Points Per Game`=2, `Passing Yards Per Game`=3, `Rushing Yards Per Game`=4, `Yards Per Game`=5
 )
collegeOffense <- collegeOffense[-c(1, 22:23, 44:45, 66:67, 88:89, 110:111, 132:133),]

collegeOffense$`Points Per Game` <- as.numeric(collegeOffense$`Points Per Game`)
collegeOffense$`Passing Yards Per Game` <- as.numeric(collegeOffense$`Passing Yards Per Game`)
collegeOffense$`Rushing Yards Per Game` <- as.numeric(collegeOffense$`Rushing Yards Per Game`)
collegeOffense$`Yards Per Game` <- as.numeric(collegeOffense$`Yards Per Game`)


#get total stats by multiplying per game stats by games played
<<<<<<< Updated upstream
collegeOffense$Points <- collegeOffense$Games * collegeOffense$PPG
collegeOffense$Yards <- collegeOffense$Games * collegeOffense$YPG
=======
>>>>>>> Stashed changes

#round all values to nearest whole number
collegeOffense <- collegeOffense %>% 
 mutate_if(is.numeric, round)

#remove unnecessary data
collegeOffense <- subset(collegeOffense, select=-c(3,4))
```

## College Data

```{r college visualization}
gf_point(Points~Yards, data=collegeOffense, linewidth=1)%>%gf_lm()
```

```{r regression analysis}
collegeModel <- lm(Points~Yards, data=collegeOffense)
mplot(collegeModel, which=1)
mplot(collegeModel, which=2)
cooksplot(collegeModel)
summary(collegeModel)
```



two data sets, one nfl teams, one college teams, does total yards affect total points scored? Is there a relationship